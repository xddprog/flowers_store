# Парсер для lascovo.ru

Скрипт для импорта букетов с сайта lascovo.ru в вашу базу данных.

## Установка зависимостей

```bash
pip install -r requirements.txt
```

## Использование

### Запуск парсера

Базовый запуск (парсит стандартные URL каталога):

```bash
cd backend
python -m scripts.parse_lascovo
```

С указанием конкретного URL:

```bash
python -m scripts.parse_lascovo --url https://lascovo.ru/catalog
```

С отладочным режимом (сохраняет HTML и выводит дополнительную информацию):

```bash
python -m scripts.parse_lascovo --url https://lascovo.ru/catalog --debug
```

Или из корня проекта:

```bash
python -m backend.scripts.parse_lascovo --url https://lascovo.ru/catalog
```

### Что делает парсер

1. Подключается к базе данных (использует настройки из `.env`)
2. Парсит каталог букетов с сайта lascovo.ru
3. Для каждого букета:
   - Извлекает название, описание, цену
   - Скачивает изображения
   - Создает букет в вашей БД через сервисы
4. Использует первый доступный тип букета из БД

### Требования

- В БД должен быть создан хотя бы один тип букета
- Настроено подключение к БД в `.env`
- Интернет-соединение для доступа к lascovo.ru

### Настройка

Если структура сайта lascovo.ru изменилась, можно обновить селекторы в методах:
- `parse_bouquet_card()` - для парсинга карточек в каталоге
- `parse_bouquet_detail()` - для парсинга детальных страниц

### Примечания

- Парсер автоматически конвертирует изображения в WebP формат
- Количество изображений ограничено до 5 на букет
- Если букет не имеет цены или названия, он будет пропущен
- Все букеты создаются с `quantity=0` (можно обновить вручную в админке)

### Отладка

Если парсер не находит букеты:

1. **Запустите с флагом `--debug`**:
   ```bash
   python -m scripts.parse_lascovo --url https://lascovo.ru/catalog --debug
   ```

2. **Откройте `debug_page.html`** в браузере и проверьте:
   - Есть ли на странице товары
   - Какие классы/селекторы используются для карточек товаров
   - Загружается ли контент через JavaScript (если да, парсер не сможет его получить)

3. **Если сайт использует JavaScript** для загрузки товаров (как lascovo.ru):
   - Парсер автоматически использует Playwright для рендеринга JavaScript
   - Убедитесь, что Playwright установлен: `playwright install chromium`
   - Если нужно отключить Playwright: `--no-playwright` (только для статических сайтов)

4. **Если товары есть в HTML**, но парсер их не находит:
   - Посмотрите на вывод отладки - там будут примеры найденных элементов
   - Обновите селекторы в методе `parse_catalog_page()` под структуру сайта

